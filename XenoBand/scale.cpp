#include "scale.h"
#include "core.h"

Scale::Scale()
{
}

double Scale::keyFrequencies[88] = {
    // 1
    27.5000,
    // 2
    29.1352,
    // 3
    30.8677,
    // 4
    32.7032,
    // 5
    34.6478,
    // 6
    36.7081,
    // 7
    38.8909,
    // 8
    41.2034,
    // 9
    43.6535,
    // 10
    46.2493,
    // 11
    48.9994,
    // 12
    51.9131,
    // 13
    55.0000,
    // 14
    58.2705,
    // 15
    61.7354,
    // 16
    65.4064,
    // 17
    69.2957,
    // 18
    73.4162,
    // 19
    77.7817,
    // 20
    82.4069,
    // 21
    87.3071,
    // 22
    92.4986,
    // 23
    97.9989,
    // 24
    103.826,
    // 25
    110.000,
    // 26
    116.541,
    // 27
    123.471,
    // 28
    130.813,
    // 29
    138.591,
    // 30
    146.832,
    // 31
    155.563,
    // 32
    164.814,
    // 33
    174.614,
    // 34
    184.997,
    // 35
    195.998,
    // 36
    207.652,
    // 37
    220.000,
    // 38
    233.082,
    // 39
    246.942,
    // 40
    261.626,
    // 41
    277.183,
    // 42
    293.665,
    // 43
    311.127,
    // 44
    329.628,
    // 45
    349.228,
    // 46
    369.994,
    // 47
    391.995,
    // 48
    415.305,
    // 49
    440.000,
    // 50
    466.164,
    // 51
    493.883,
    // 52
    523.251,
    // 53
    554.365,
    // 54
    587.330,
    // 55
    622.254,
    // 56
    659.255,
    // 57
    698.456,
    // 58
    739.989,
    // 59
    783.991,
    // 60
    830.609,
    // 61
    880.000,
    // 62
    932.328,
    // 63
    987.767,
    // 64
    1046.50,
    // 65
    1108.73,
    // 66
    1174.66,
    // 67
    1244.51,
    // 68
    1318.51,
    // 69
    1396.91,
    // 70
    1479.98,
    // 71
    1567.98,
    // 72
    1661.22,
    // 73
    1760.00,
    // 74
    1864.66,
    // 75
    1975.53,
    // 76
    2093.00,
    // 77
    2217.46,
    // 78
    2349.32,
    // 79
    2489.02,
    // 80
    2637.02,
    // 81
    2793.83,
    // 82
    2959.96,
    // 83
    3135.96,
    // 84
    3322.44,
    // 85
    3520.00,
    // 86
    3729.31,
    // 87
    3951.07,
    // 88
    4186.01

};

/*
 * Returns the converted frequency of the given key. If the frequency is out of human ears range, then return 0 instead.
 *
 * Frequency range for human ears: 20-20000Hz
 */
double Scale::getFrequency(int key)
{
    double result = 0.0;
    int index = key - 21;
    if(0 <= index <= 87)
        result = keyFrequencies[index];
    else if(index < 0)
        result = keyFrequencies[0] / (pow(2.0, (0 - index) / 12.0));
    else
        result = keyFrequencies[87] * (pow(2.0, (index - 87) / 12.0));
    if(result < 20.0 || result > 20000.0)
        result = 0.0;
    return result;

}
